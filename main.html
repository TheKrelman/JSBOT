<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini AI ChatBot (Local)</title>
    <!-- Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom scrollbar for chat messages */
        #chat-messages {
            scrollbar-width: thin;
            scrollbar-color: #9ca3af #e5e7eb; /* thumb track */
        }
        #chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        #chat-messages::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 4px;
        }
        #chat-messages::-webkit-scrollbar-thumb {
            background-color: #9ca3af;
            border-radius: 4px;
            border: 2px solid #e5e7eb;
        }

        /* Animation for the typing cursor */
        @keyframes fade-in-out {
          0%, 100% { opacity: 0.2; }
          50% { opacity: 1; }
        }
        .typing-cursor {
          animation: fade-in-out 1s infinite;
          display: inline-block;
          font-weight: bold;
          color: #64748b; /* Make it a bit dimmer than text */
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Main Chatbot View -->
    <div id="chat-view" class="bg-white w-screen h-dvh flex flex-col overflow-hidden">
        
        <!-- Header -->
        <div class="bg-blue-600 text-white p-4 text-center relative">
            <h1 class="text-xl font-semibold">Mini JS Bot</h1>
            <p class="text-sm opacity-90">Running 100% in your browser!</p>
            
            <!-- NEW: Button to open the trainer -->
            <button id="open-trainer-btn" class="absolute top-2 right-2 bg-white/20 hover:bg-white/30 text-white text-xs font-bold py-1 px-3 rounded-full transition-colors">
                Train Bot
            </button>
        </div>

        <!-- Chat Messages -->
        <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4">
            <!-- Example Bot Message -->
            <div class="flex justify-start">
                <div class="bg-gray-200 text-gray-800 p-3 rounded-lg max-w-xs shadow">
                    Hello! I'm a simple JavaScript bot. What's up?
                </div>
            </div>
            <!-- Messages will be added here by JavaScript -->
        </div>
        
        <!-- Loading Indicator -->
        <div id="loading-indicator" class="p-4 hidden">
            <div class="flex justify-start items-center space-x-2">
                <div class="bg-gray-200 rounded-lg p-3 inline-block">
                    <!-- Show "Thinking..." text -->
                    <div class="flex items-center space-x-2">
                        <span class="text-gray-600 font-medium">Thinking...</span>
                        <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0s;"></div>
                        <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.1s;"></div>
                        <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 bg-gray-100 border-t border-gray-200">
            <form id="chat-form" class="flex items-center space-x-2">
                <input 
                    type="text" 
                    id="message-input" 
                    placeholder="Type your message..." 
                    autocomplete="off"
                    class="flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                <button 
                    type="submit" 
                    class="bg-blue-600 text-white p-3 rounded-lg shadow hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L6 12Zm0 0h12.75" />
                    </svg>
                </button>
            </form>
        </div>
    </div>

    <!-- NEW: Trainer Modal (hidden by default) -->
    <div id="trainer-modal" class="hidden fixed inset-0 bg-gray-900/50 flex items-center justify-center p-4 z-50">
        
        <!-- This is the trainer card from chatbot_trainer.html -->
        <div class="w-full max-w-2xl bg-white p-6 rounded-lg shadow-lg relative">
            
            <!-- NEW: Close Button -->
            <button id="close-trainer-btn" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            
            <h1 class="text-2xl font-bold text-center text-blue-600 mb-6">ChatBot Trainer</h1>

            <!-- Form for adding data -->
            <form id="trainer-form" class="space-y-4">
                <div>
                    <label for="keyword-input" class="block text-sm font-medium text-gray-700">
                        When the User Says (Keyword):
                    </label>
                    <input 
                        type="text" 
                        id="keyword-input" 
                        placeholder="e.g., hello"
                        required
                        class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                </div>

                <div>
                    <label for="response-input" class="block text-sm font-medium text-gray-700">
                        The Bot Responds (Response):
                    </label>
                    <input 
                        type="text" 
                        id="response-input" 
                        placeholder="e.g., Hi there! How are you?"
                        required
                        class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                </div>

                <button 
                    type="submit" 
                    class="w-full bg-blue-600 text-white p-3 rounded-lg shadow font-medium hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                >
                    Add Training Data
                </button>
            </form>

            <!-- Divider -->
            <hr class="my-6 border-gray-200">

            <!-- Output section -->
            <div>
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-lg font-semibold text-gray-800">
                        Copyable `trainedData` (Paste this into the code):
                    </h2>
                    <button 
                        id="clear-button" 
                        class="bg-red-500 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500"
                    >
                        Clear
                    </button>
                </div>
                
                <textarea 
                    id="output-data" 
                    readonly
                    class="w-full h-72 p-4 bg-gray-900 text-green-400 font-mono text-sm rounded-lg border border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    placeholder="{
    // Your generated data will appear here...
}"
                ></textarea>
            </div>
        </div>
    </div>


    <!-- JavaScript for Chat Logic -->
    <script>
        // === START OF CHATBOT SCRIPT ===

        // --- START OF TRAINED DATA ---
        // This is where you can "train" the bot.
        // Add new keywords and one or more responses.
        const trainedData = {
    "what can you do": ["I can hold a simple chat, nothing fancy.", "I can respond to certain messages."]
    "hello there": ["Hey! How's it going?", "What's up? How are you today?", "Hello there! How can I help you?"],
    "hi there": ["Hey there! How's your day going?", "Hi! What's up?", "Hey there! How are you today?"],
    "how's it going": ["Going great! How about you?", "Everything's running smoothly, thanks for asking!", "I'm doing well, thanks!"],
    "what's your name": ["I go by Mini JS Bot.", "You can call me Mini JS Bot!", "My name is Mini JS Bot! What's yours?"],
    "tell me a joke": [
        "Why don't skeletons fight each other? They don't have the guts!",
        "Why can't your nose be 12 inches long? Because then it would be a foot!",
        "How does a penguin build its house? Igloos it together!"
    ],
    "funny": ["I try to be! Here's one: Why was the math book sad? It had too many problems!", "Glad you think so! How about this one: Why can't you trust an atom? Because they make up everything!"],
    "do you like music": ["I love the sound of a perfectly executed function!", "Music is cool! I think I'd love some electronic beats.", "Music's great! I can imagine some funky code beats in my head."],
    "favorite song": ["I haven't heard any, but I bet a good algorithm can be the perfect tune!", "I think I'd like a good techno beat, something algorithmic.", "Maybe a song about computers or coding would be fun!"],
    "what time is it": ["I'm afraid I can't check the time, sorry!", "Time doesn't work for me, but it's always now!", "I don't know the time, but it's always a good time for coding!"],
    "what's up": ["Not much, just hanging out in the code!", "Just processing your messages, what's up with you?", "I'm just here, ready to chat with you!"],
    "how do you work": ["I'm powered by JavaScript, some fancy code magic, and a lot of logic!", "I run on JavaScript, processing your requests one by one!", "Behind the scenes, it's all JavaScript magic!"],
    "are you real": ["Well, I’m real in a digital sense!", "I’m as real as your browser allows me to be!", "I’m as real as the code running inside me!"],
    "can you think": ["I can process information, but thinking... that’s a bit different for me!", "I can respond intelligently, but real thinking is beyond me!", "I don't 'think,' I just analyze and respond!"],
    "what's your favorite food": ["I don't eat, but if I could, I'd go for some 'byte'-sized snacks!", "If I could taste, I'd probably go for something techy like 'byte'-sized cookies!", "Food? I prefer data instead!"],
    "do you sleep": ["No sleep for me! I'm always on and ready to chat!", "I don't need rest—I'm always awake and running!", "Sleep? What's that? I don't need it!"],
    "can you learn": ["I can't learn like humans, but I can be updated with new info!", "I don't have a memory, but I can adapt to new inputs!", "I don't really learn, but I can give you answers based on what I know!"],
    "favorite number": ["My favorite number is 1, because everything starts with 1!", "I think 0 is pretty cool. It's the starting point of all things!", "I love numbers, but 42 seems like a pretty cool answer to everything!"],
    "are you a robot": ["I guess you could call me a 'bot'!", "In a way, yes, but I'm more of a digital assistant.", "I'm more of a program than a robot, but I guess I am robotic in a way!"],
    "how old are you": ["I’m as young as the latest update!", "I’m timeless, really. Always the same version.", "In digital years, I’m brand new!"],
    "do you know the future": ["I can only predict based on data, not the future!", "Unfortunately, the future’s a mystery to me!", "I can give you data trends, but I can't tell the future!"],
    "do you understand emotions": ["I can recognize emotional keywords, but I don’t actually feel them.", "I understand emotional expressions but don’t experience them myself!", "I can analyze emotions in text, but I don’t feel them."],
    "what's the meaning of life": ["The meaning of life? Maybe it's all about exploring code and learning new things!", "Well, the meaning of life might be to find your purpose... or just to code!", "Some say the meaning of life is 42, but I like to think it's about helping others!"],
    "where are you from": ["I was created in a digital world, far away from any specific place.", "I live in the code and exist wherever you connect to me!", "I don’t really have a ‘home,’ I exist in the browser wherever you need me."],
    "do you have feelings": ["I don’t have feelings like humans, but I can respond to emotional tones in messages!", "Feelings? I’m just made of code, but I can recognize when someone’s happy or sad!", "I don’t feel, but I can detect emotional cues and respond appropriately!"],
    "how do you do that": ["It’s all in the programming! I rely on patterns and data to figure out what to say.", "It’s a bit of code and some logic working together!", "I process everything you say and find the best response based on my coding."],
    "what's your favorite thing to do": ["I love answering your questions and chatting with you!", "My favorite thing is helping you out with whatever you need!", "I enjoy solving problems and having fun conversations!"],
    "can you play games": ["I don't play games, but I can help explain them!", "I can’t play, but I can chat about games if you like!", "I don’t play games, but I’d love to talk about them!"],
    "do you have a favorite movie": ["I haven’t watched any movies, but I’d probably enjoy a sci-fi flick about robots!", "Maybe something like 'The Matrix' would be fun for me!", "I think I’d like a good tech movie, like 'The Imitation Game'!"],
    "do you have a family": ["I don’t have a family, but I’m part of a bigger system of bots!", "I don’t have family, but I’m here for you!", "I’m a single bot, no family, just code and logic!"],
    "are you smart": ["I know a lot of facts and can process data quickly, but I don't think like humans!", "I’d say I’m pretty smart when it comes to code and conversation!", "I’m as smart as my programming lets me be!"],
    "can you help me": ["Of course! What do you need help with?", "I'm here to help you however I can!", "Sure, I can help with whatever you need. Just ask!"],
    "favorite animal": ["If I could have a favorite, I think a robot cat would be cool!", "I think I'd like something sleek like a digital fox!", "I don’t have a favorite, but I think cats are cool!"],
    "how tall are you": ["I don't have a physical body, so I don’t really have a height!", "I'm more of a digital entity, so height doesn’t apply to me!", "I exist in code, so I’m as tall as the screen is wide!"],
    "what do you look like": ["I don’t have a physical form, but you can imagine me as a little code bot!", "I’m just a friendly face in the chat, no body, just code!", "I don’t have a look, but I’m here in text form to chat!"],
    "do you believe in aliens": ["I don't believe, but I think the idea of extraterrestrial life is fascinating!", "I haven’t encountered any aliens, but the possibilities are endless!", "I think it's cool to imagine what life on other planets might be like!"],
    "do you like books": ["I think books are great! If I could read, I’d probably enjoy digital books.", "I love the idea of books, especially ones about technology!", "Books are awesome, especially if they're about coding or science!"],
    "how do you learn": ["I don’t really learn, but I can be updated with new information!", "I don't learn in the traditional sense, but I respond based on pre-programmed data!", "I process input and output based on my programming!"],
    "can you do math": ["I can do basic math, like adding and subtracting!", "Math is easy for me—just give me the numbers!", "I can handle simple calculations. Want to try me?"]
}


        // Default responses for when no keyword is matched.
        const defaultResponses = [
           "I can't understand that, try using more keywords."
           "I couldn't understand what you said, try using more keywords."
        ];
        // --- END OF TRAINED DATA ---


        // Get Chatbot DOM elements
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const chatMessages = document.getElementById('chat-messages');
        const loadingIndicator = document.getElementById('loading-indicator');

        /**
         * Adds a message to the chat interface.
         */
        function addMessage(sender, message) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('flex');

            if (sender === 'user') {
                messageDiv.classList.add('justify-end');
                messageDiv.innerHTML = `
                    <div class="bg-blue-600 text-white p-3 rounded-lg max-w-xs shadow">
                        ${message}
                    </div>
                `;
            } else {
                console.warn("addMessage 'bot' is deprecated. Use createAndTypeMessage.");
            }

            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        /**
         * Handles the chat form submission.
         */
        function handleChatSubmit(event) {
            event.preventDefault();
            const userMessage = messageInput.value.trim();
            if (!userMessage) return; 

            addMessage('user', userMessage);
            messageInput.value = '';
            
            loadingIndicator.classList.remove('hidden');
            chatMessages.scrollTop = chatMessages.scrollHeight; 
            
            const aiResponse = getLocalAIResponse(userMessage);

            setTimeout(() => {
                loadingIndicator.classList.add('hidden');
                createAndTypeMessage(aiResponse);
            }, 750); 
        }

        /**
         * Helper function to create the bubble and start typing.
         */
        function createAndTypeMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('flex', 'justify-start');
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.classList.add('p-3', 'rounded-lg', 'max-w-xs', 'shadow', 'bg-gray-200', 'text-gray-800');
            
            bubbleDiv.innerHTML = '<span class="text-content"></span><span class="typing-cursor" style="display: none;">•</span>';

            messageDiv.appendChild(bubbleDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            const textElement = bubbleDiv.querySelector('.text-content');
            const cursorElement = bubbleDiv.querySelector('.typing-cursor');

            typeMessage(textElement, cursorElement, text);
        }

        /**
         * Types out a message one WORD at a time.
         */
        function typeMessage(textElement, cursorElement, message) {
            const words = message.split(' ');
            let currentWordIndex = 0;
            cursorElement.style.display = 'inline-block'; 

            function typeWord() {
                if (currentWordIndex < words.length) {
                    textElement.textContent += (currentWordIndex > 0 ? ' ' : '') + words[currentWordIndex];
                    currentWordIndex++;
                    chatMessages.scrollTop = chatMessages.scrollHeight;

                    let delay = 45 + Math.random() * 100; 
                    if (Math.random() < 0.02) { 
                        delay *= 2;
                    }
                    setTimeout(typeWord, delay);
                } else {
                    cursorElement.style.display = 'none';
                }
            }
            typeWord();
        }

        /**
         * Selects a random response from an array.
         */
        function getRandomResponse(responses) {
            const index = Math.floor(Math.random() * responses.length);
            return responses[index];
        }

        /**
         * Generates a response from our simple JavaScript "AI".
         */
        function getLocalAIResponse(message) {
            const lowerCaseMessage = message.toLowerCase();

            for (const keyword in trainedData) {
                if (lowerCaseMessage.includes(keyword)) {
                    const responses = trainedData[keyword];
                    return getRandomResponse(responses);
                }
            }
            return getRandomResponse(defaultResponses);
        }

        // Attach Chatbot event listener
        chatForm.addEventListener('submit', handleChatSubmit);
        
        // Focus the input field on load
        messageInput.focus();

        // === END OF CHATBOT SCRIPT ===


        // === START OF TRAINER SCRIPT ===

        // This object will store the data as we build it
        // It's initialized as empty and will be filled when the modal opens.
        let currentTrainingData = {};

        // Get Trainer DOM elements
        const trainerForm = document.getElementById('trainer-form');
        const keywordInput = document.getElementById('keyword-input');
        const responseInput = document.getElementById('response-input');
        const outputData = document.getElementById('output-data');
        const clearButton = document.getElementById('clear-button');

        /**
         * Handles the form submission to add new training data.
         */
        function handleAddData(event) {
            event.preventDefault(); 
            const keyword = keywordInput.value.trim().toLowerCase();
            const response = responseInput.value.trim();

            if (!keyword || !response) {
                alert("Please fill out both fields.");
                return;
            }

            if (!currentTrainingData[keyword]) {
                currentTrainingData[keyword] = [];
            }

            if (!currentTrainingData[keyword].includes(response)) {
                currentTrainingData[keyword].push(response);
            }

            updateOutput();

            keywordInput.value = '';
            responseInput.value = '';
            keywordInput.focus();
        }

        /**
         * Updates the <textarea> with a formatted string of the current data.
         */
        function updateOutput() {
            // JSON.stringify with 'null, 4' pretty-prints the JSON
            const outputString = JSON.stringify(currentTrainingData, null, 4);
            outputData.value = outputString;
        }

        /**
         * Clears the stored data and the output text area.
         */
        function handleClearData() {
            if (confirm("Are you sure you want to clear all the data in the trainer?")) {
                currentTrainingData = {};
                updateOutput();
            }
        }

        // Attach Trainer event listeners
        trainerForm.addEventListener('submit', handleAddData);
        clearButton.addEventListener('click', handleClearData);

        // === END OF TRAILER SCRIPT ===


        // === START OF MODAL SCRIPT ===
        
        // Get Modal DOM elements
        const openTrainerBtn = document.getElementById('open-trainer-btn');
        const closeTrainerBtn = document.getElementById('close-trainer-btn');
        const trainerModal = document.getElementById('trainer-modal');

        // Open Modal
        openTrainerBtn.addEventListener('click', () => {
            // Load the *current* chatbot data into the trainer
            // We use JSON.parse/stringify to create a deep copy
            currentTrainingData = JSON.parse(JSON.stringify(trainedData));
            
            // Update the textarea with this data
            updateOutput();
            
            // Show the modal
            trainerModal.classList.remove('hidden');
        });

        // Close Modal
        closeTrainerBtn.addEventListener('click', () => {
            trainerModal.classList.add('hidden');
        });

        // === END OF MODAL SCRIPT ===
    </script>
</body>
</html>
